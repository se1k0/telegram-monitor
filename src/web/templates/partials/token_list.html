<div class="token-list-container">
    <!-- 加载状态提示 -->
    <div id="initial-loading" class="loading-indicator py-5">
        <div class="spinner"></div>
        <div class="mt-3 text-center">
            <h5 class="mb-2">正在加载代币数据</h5>
            <p class="text-muted small">首次加载可能需要几秒钟...</p>
        </div>
    </div>

    <!-- 暂无数据提示 -->
    <div id="no-tokens-message" class="py-5 text-center" style="display: none;">
        <i class="bi bi-inbox text-muted" style="font-size: 3rem;"></i>
        <h5 class="mt-3">暂无代币数据</h5>
        <p class="text-muted">尝试更改筛选条件或添加新代币</p>
    </div>

    <!-- 代币表格 -->
    <div class="table-responsive" id="token-table-container" style="display: none;">
        <table class="token-table table align-middle mb-0">
            <thead>
                <tr>
                    <th class="text-nowrap">
                        <div class="d-flex align-items-center">
                            代币名称
                            <span class="sort-btn" data-sort="name">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap">
                        <div class="d-flex align-items-center">
                            链
                            <span class="sort-btn" data-sort="chain">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-md-table-cell">
                        <div class="d-flex align-items-center">
                            市值
                            <span class="sort-btn" data-sort="market_cap">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-lg-table-cell">
                        <div class="d-flex align-items-center">
                            24h 变化
                            <span class="sort-btn" data-sort="change_24h">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-lg-table-cell">
                        <div class="d-flex align-items-center">
                            成交量
                            <span class="sort-btn" data-sort="volume">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-xl-table-cell">
                        <div class="d-flex align-items-center">
                            买入/卖出
                            <span class="sort-btn" data-sort="buys_sells">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-xl-table-cell">
                        <div class="d-flex align-items-center">
                            持有者
                            <span class="sort-btn" data-sort="holders">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-xl-table-cell">
                        <div class="d-flex align-items-center">
                            社区覆盖
                            <span class="sort-btn" data-sort="community_reach">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-xl-table-cell">
                        <div class="d-flex align-items-center">
                            消息覆盖
                            <span class="sort-btn" data-sort="spread_count">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap d-none d-lg-table-cell">
                        <div class="d-flex align-items-center">
                            首次发现
                            <span class="sort-btn" data-sort="first_seen">
                                <i class="bi bi-caret-up-fill"></i>
                                <i class="bi bi-caret-down-fill"></i>
                            </span>
                        </div>
                    </th>
                    <th class="text-nowrap">操作</th>
                </tr>
            </thead>
            <tbody id="tokens-container">
                <!-- 代币将被动态添加到这里 -->
            </tbody>
        </table>
    </div>

    <!-- 加载更多指示器 -->
    <div id="load-more" class="loading-indicator py-4" style="display: none;">
        <div class="spinner"></div>
        <div class="mt-2 text-center">
            <p class="text-muted small mb-0">加载更多代币...</p>
        </div>
    </div>
</div>

<!-- 代币行模板 -->
<template id="token-row-template">
    <tr class="token-row" data-id="TOKEN_ID">
        <!-- 代币名称列 -->
        <td>
            <div class="d-flex align-items-center">
                <img src="TOKEN_ICON" alt="TOKEN_NAME" class="token-icon" onerror="this.src='/static/img/default-token.png'">
                <div class="w-100">
                    <!-- 第一行：代币名称和社交媒体第一排 -->
                    <div class="d-flex align-items-center">
                        <div class="token-name">TOKEN_NAME <span class="token-symbol">TOKEN_SYMBOL</span></div>
                        <!-- 社交媒体第一排 - 由JS动态填充 -->
                        <div class="social-links-row1 ms-auto"></div>
                    </div>
                    <!-- 第二行：合约地址和社交媒体第二排 -->
                    <div class="d-flex align-items-center mt-1">
                        <div class="contract-address small text-muted d-flex align-items-center">
                            <span data-address="TOKEN_CONTRACT">TOKEN_CONTRACT_SHORT</span>
                            <button class="btn btn-sm btn-link text-muted p-0 ms-1 copy-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="复制地址" data-address="TOKEN_CONTRACT">
                                <i class="bi bi-clipboard"></i>
                            </button>
                        </div>
                        <!-- 社交媒体第二排 - 由JS动态填充 -->
                        <div class="social-links-row2 ms-auto"></div>
                    </div>
                </div>
            </div>
        </td>
        
        <!-- 链 -->
        <td>
            <span class="badge-chain CHAIN_CLASS">TOKEN_CHAIN</span>
        </td>
        
        <!-- 市值 -->
        <td class="d-none d-md-table-cell fw-medium">TOKEN_MARKET_CAP</td>
        
        <!-- 24小时变化 -->
        <td class="d-none d-lg-table-cell TOKEN_CHANGE_CLASS">TOKEN_CHANGE_24H</td>
        
        <!-- 成交量 -->
        <td class="d-none d-lg-table-cell fw-medium">TOKEN_VOLUME</td>
        
        <!-- 买入/卖出 -->
        <td class="d-none d-xl-table-cell">
            <div class="d-flex align-items-center">
                <span class="me-2 positive-change">TOKEN_BUYS<i class="bi bi-arrow-up-short"></i></span>
                <span class="negative-change">TOKEN_SELLS<i class="bi bi-arrow-down-short"></i></span>
            </div>
        </td>
        
        <!-- 持有者 -->
        <td class="d-none d-xl-table-cell">TOKEN_HOLDERS</td>
        
        <!-- 社区覆盖 -->
        <td class="d-none d-xl-table-cell">TOKEN_COMMUNITY_REACH</td>
        
        <!-- 消息覆盖 -->
        <td class="d-none d-xl-table-cell">TOKEN_SPREAD_COUNT</td>
        
        <!-- 首次发现 -->
        <td class="d-none d-lg-table-cell text-nowrap">
            <div class="d-flex align-items-center">
                <i class="bi bi-clock me-1 text-muted"></i>
                <span class="small">TOKEN_FIRST_SEEN</span>
            </div>
        </td>
        
        <!-- 操作 -->
        <td>
            <div class="d-flex">
                <button class="btn btn-sm btn-outline-secondary me-1 refresh-token-btn" 
                        data-token-id="TOKEN_ID" 
                        data-chain="TOKEN_CHAIN" 
                        data-contract="TOKEN_CONTRACT"
                        data-token-symbol="TOKEN_SYMBOL"
                        onclick="refreshTokenData(this)">
                    <span class="spinner-border spinner-border-sm d-none" role="status"></span>
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
                <button class="btn btn-sm btn-primary view-token-btn" 
                        data-token-id="TOKEN_ID"
                        data-bs-toggle="modal" 
                        data-bs-target="#tokenDetailModal">
                    <i class="bi bi-box-arrow-up-right"></i>
                </button>
            </div>
        </td>
    </tr>
</template>

<script>
// 复制功能
document.addEventListener('click', function(e) {
    if(e.target.closest('.copy-btn')) {
        const button = e.target.closest('.copy-btn');
        const address = button.dataset.address;
        
        // 复制到剪贴板
        navigator.clipboard.writeText(address).then(function() {
            // 复制成功，显示提示
            button.innerHTML = '<i class="bi bi-check"></i>';
            setTimeout(() => {
                button.innerHTML = '<i class="bi bi-clipboard"></i>';
            }, 2000);
            
            // 显示提示
            showToast('地址已复制到剪贴板', 'success');
        }, function() {
            // 复制失败，显示错误
            showToast('复制失败，请手动复制', 'error');
        });
    }
});

// 创建提示容器
if (!document.querySelector('.toast-container')) {
    const toastContainer = document.createElement('div');
    toastContainer.className = 'toast-container position-fixed bottom-0 end-0 p-3';
    document.body.appendChild(toastContainer);
}

// 显示提示信息
function showToast(message, type = 'info') {
    const toastContainer = document.querySelector('.toast-container');
    
    // 创建toast元素
    const toastEl = document.createElement('div');
    toastEl.className = `toast align-items-center text-white bg-${type === 'success' ? 'success' : type === 'error' ? 'danger' : 'info'} border-0`;
    toastEl.setAttribute('role', 'alert');
    toastEl.setAttribute('aria-live', 'assertive');
    toastEl.setAttribute('aria-atomic', 'true');
    
    // 创建toast内容
    const toastBody = document.createElement('div');
    toastBody.className = 'd-flex';
    
    const toastContent = document.createElement('div');
    toastContent.className = 'toast-body';
    toastContent.textContent = message;
    
    const closeButton = document.createElement('button');
    closeButton.type = 'button';
    closeButton.className = 'btn-close btn-close-white me-2 m-auto';
    closeButton.setAttribute('data-bs-dismiss', 'toast');
    closeButton.setAttribute('aria-label', '关闭');
    
    // 组装toast
    toastBody.appendChild(toastContent);
    toastBody.appendChild(closeButton);
    toastEl.appendChild(toastBody);
    toastContainer.appendChild(toastEl);
    
    // 初始化Bootstrap Toast
    const toast = new bootstrap.Toast(toastEl, {
        delay: 3000
    });
    
    // 显示toast
    toast.show();
    
    // 在Toast隐藏后从DOM中移除元素
    toastEl.addEventListener('hidden.bs.toast', function () {
        toastEl.remove();
    });
}

// 初始化工具提示
function initTooltips() {
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
}

// 页面加载完成后初始化工具提示
document.addEventListener('DOMContentLoaded', function() {
    initTooltips();
});
</script> 